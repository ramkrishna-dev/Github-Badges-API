<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - GitHub Badge API 3.0</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        .badge-preview { margin: 10px; }
        .analytics { margin-top: 20px; }
        .form-group { margin: 10px 0; }
        label { display: block; margin-bottom: 5px; }
        input, select { width: 100%; padding: 8px; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; cursor: pointer; }
        .badge-grid { display: flex; flex-wrap: wrap; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Developer Dashboard</h1>
        <p>GitHub Badge API 3.0 - Test and manage your badges.</p>

        <h2>Test Badge Generator</h2>
        <form id="badgeForm">
            <div class="form-group">
                <label>Provider: <select id="provider"><option value="github">GitHub</option></select></label>
            </div>
            <div class="form-group">
                <label>Owner: <input id="owner" value="microsoft"></label>
            </div>
            <div class="form-group">
                <label>Repo: <input id="repo" value="vscode"></label>
            </div>
            <div class="form-group">
                <label>Metric: <select id="metric"><option value="stars">Stars</option><option value="forks">Forks</option><option value="issues">Issues</option></select></label>
            </div>
            <div class="form-group">
                <label>Style: <select id="style"><option value="flat">Flat</option><option value="neon">Neon</option><option value="cyberpunk">Cyberpunk</option></select></label>
            </div>
            <div class="form-group">
                <label>Color: <input id="color" value="#4c1"></label>
            </div>
            <div class="form-group">
                <label>Icon: <select id="icon"><option value="">None</option><option value="github">GitHub</option><option value="star">Star</option></select></label>
            </div>
            <button type="submit">Generate Badge</button>
        </form>

        <div class="badge-preview" id="preview"></div>

        <h2>Compose Badges</h2>
        <form id="composeForm">
            <div class="form-group">
                <label>Badges (comma-separated): <input id="badges" value="stars,forks"></label>
            </div>
            <div class="form-group">
                <label>Layout: <select id="layout"><option value="horizontal">Horizontal</option></select></label>
            </div>
            <button type="submit">Compose</button>
        </form>
        <div class="badge-preview" id="composePreview"></div>

        <h2>Analytics</h2>
        <div class="analytics" id="analytics"></div>
    </div>

    <script>
        document.getElementById('badgeForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const provider = document.getElementById('provider').value;
            const owner = document.getElementById('owner').value;
            const repo = document.getElementById('repo').value;
            const metric = document.getElementById('metric').value;
            const style = document.getElementById('style').value;
            const color = document.getElementById('color').value;
            const icon = document.getElementById('icon').value;

            const url = `/v2/badge/${provider}/${owner}/${repo}/${metric}?style=${style}&color=${color}&icon=${icon}`;
            document.getElementById('preview').innerHTML = `<img src="${url}" alt="Badge">`;
        });

        document.getElementById('composeForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const badges = document.getElementById('badges').value;
            const layout = document.getElementById('layout').value;

            const url = `/v2/compose?badges=${badges}&layout=${layout}`;
            document.getElementById('composePreview').innerHTML = `<img src="${url}" alt="Composed Badge">`;
        });

        // Load analytics
        fetch('/dashboard/analytics').then(r => r.json()).then(data => {
            document.getElementById('analytics').innerHTML = `
                <p>Total Renders: ${data.total_renders || 0}</p>
                <p>Popular Metrics: ${data.popular_metrics ? data.popular_metrics.map(m => m.metric).join(', ') : 'None'}</p>
            `;
        });
    </script>
</body>
</html>